---
description: Commit message format and auto-commit policy
alwaysApply: true
---

# Commit Message Convention

**ALWAYS** use the `type(scope): description` format for ALL commits.

## Format (Required)

```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

### Type (Required)

| Type | Description |
|------|-------------|
| `feat` | New feature |
| `fix` | Bug fix |
| `docs` | Documentation changes |
| `refactor` | Code refactoring |
| `test` | Adding or updating tests |
| `chore` | Maintenance tasks, dependencies |
| `style` | Code style/formatting changes |
| `perf` | Performance improvements |
| `ci` | CI/CD configuration |
| `build` | Build system changes |

### Scope (Required)

The scope indicates which part of the codebase is affected:

| Scope | When to use |
|-------|-------------|
| `core` | armature-core crate |
| `auth` | armature-auth, armature-oauth2, armature-saml |
| `cache` | armature-cache, armature-redis |
| `queue` | armature-queue |
| `di` | armature-di |
| `macros` | armature-proc-macro |
| `cli` | armature-cli |
| `ws` | armature-websocket |
| `sse` | armature-sse |
| `db` | armature-diesel, armature-seaorm |
| `aws` | armature-aws |
| `gcp` | armature-gcp |
| `azure` | armature-azure |
| `docs` | Documentation files |
| `examples` | Example code |
| `tests` | Test files |
| `deps` | Dependency updates |

### Examples

```bash
# Features
git commit -m "feat(auth): add OAuth2 provider support"
git commit -m "feat(queue): implement job retry with exponential backoff"
git commit -m "feat(ws): add room-based message broadcasting"

# Bug fixes
git commit -m "fix(cache): resolve Redis connection timeout"
git commit -m "fix(core): handle empty request body correctly"

# Documentation
git commit -m "docs(readme): update installation instructions"
git commit -m "docs(auth): add JWT configuration examples"

# Refactoring
git commit -m "refactor(core): simplify error handling"
git commit -m "refactor(macros): reduce code duplication in derive macros"

# Tests
git commit -m "test(auth): add integration tests for OAuth2 flow"

# Chores
git commit -m "chore(deps): update tokio to 1.35"

# Breaking changes (add ! after scope)
git commit -m "feat(api)!: change response format to camelCase"
```

## Auto-Commit Policy

Commit after completing tasks that modify files:
- ✅ Implementing a feature
- ✅ Fixing a bug
- ✅ Refactoring code
- ✅ Adding/updating documentation
- ✅ Creating new files
- ✅ Modifying configuration

Do NOT commit when:
- ❌ Changes are incomplete or broken
- ❌ Tests are failing
- ❌ User explicitly asks not to commit
- ❌ Only reading files (no modifications)

## Multi-File Commits

When changes span multiple crates, use the most significant scope or `core`:

```bash
# Changes to multiple crates for a single feature
git commit -m "feat(auth): add session management with Redis storage"

# Dependency updates across workspace
git commit -m "chore(deps): update workspace dependencies"
```
