<article class="doc-content">
  <!-- Hero Section -->
  <header class="doc-hero">
    <div class="hero-badge">
      <span class="badge-icon">üîÑ</span>
      <span class="badge-text">Reverse Proxy</span>
    </div>
    <h1>Ferron Integration</h1>
    <p class="hero-description">
      High-performance reverse proxy integration with configuration generation,
      load balancing, service discovery, and health checking.
    </p>
    <div class="hero-links">
      <a href="https://ferron.sh" target="_blank" rel="noopener noreferrer" class="doc-btn-primary">
        Ferron Website ‚Üí
      </a>
      <a href="https://docs.rs/armature-ferron" target="_blank" rel="noopener noreferrer" class="doc-btn-secondary">
        API Docs
      </a>
    </div>
  </header>

  <!-- Features Grid -->
  <section class="features-section">
    <h2>Features</h2>
    <div class="features-grid">
      @for (feature of features; track feature.title) {
        <div class="feature-card">
          <span class="feature-icon">{{ feature.icon }}</span>
          <h3>{{ feature.title }}</h3>
          <p>{{ feature.description }}</p>
        </div>
      }
    </div>
  </section>

  <!-- Installation -->
  <section class="section">
    <h2>Installation</h2>
    <p>Add <code>armature-ferron</code> to your <code>Cargo.toml</code>:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">toml</span>
        <span class="code-file">Cargo.toml</span>
      </div>
      <pre><code>[dependencies]
armature-ferron = "0.1"</code></pre>
    </div>
    <p class="note">
      <strong>Note:</strong> Install Ferron from <a href="https://ferron.sh" target="_blank">ferron.sh</a>
      to use process management features.
    </p>
  </section>

  <!-- Quick Start -->
  <section class="section">
    <h2>Quick Start</h2>
    <h3>Basic Reverse Proxy</h3>
    <p>Generate a simple Ferron configuration programmatically:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
        <span class="code-file">main.rs</span>
      </div>
      <pre><code>{{ codeExamples.basicProxy }}</code></pre>
    </div>
    <div class="output-block">
      <div class="output-header">Generated KDL Configuration</div>
      <pre><code>api.example.com &#123;
    tls auto
    hsts max_age=31536000
    gzip level=6
    proxy "http://localhost:3000"
&#125;</code></pre>
    </div>
  </section>

  <!-- Load Balancing -->
  <section class="section">
    <h2>Load Balancing</h2>
    <p>Configure load balancing across multiple backends:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
      </div>
      <pre><code>{{ codeExamples.loadBalancing }}</code></pre>
    </div>

    <h3>Load Balancing Strategies</h3>
    <div class="table-container">
      <table class="doc-table">
        <thead>
          <tr>
            <th>Strategy</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          @for (strategy of loadBalanceStrategies; track strategy.name) {
            <tr>
              <td><code>{{ strategy.name }}</code></td>
              <td>{{ strategy.description }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </section>

  <!-- Service Discovery -->
  <section class="section">
    <h2>Service Discovery</h2>
    <p>Dynamically register and manage backend instances:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
      </div>
      <pre><code>{{ codeExamples.serviceDiscovery }}</code></pre>
    </div>

    <div class="info-box">
      <h4>Key Capabilities</h4>
      <ul>
        <li><strong>Dynamic Registration</strong> - Add/remove backends without restart</li>
        <li><strong>Health Status</strong> - Track healthy/unhealthy instances</li>
        <li><strong>Heartbeat</strong> - Automatic stale instance cleanup</li>
        <li><strong>Change Notifications</strong> - React to service changes</li>
      </ul>
    </div>
  </section>

  <!-- Health Checking -->
  <section class="section">
    <h2>Health Checking</h2>
    <p>Monitor backend health with configurable checks:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
      </div>
      <pre><code>{{ codeExamples.healthCheck }}</code></pre>
    </div>

    <h3>Health Check Configuration</h3>
    <div class="config-grid">
      <div class="config-item">
        <span class="config-name">path</span>
        <span class="config-desc">Health endpoint path (e.g., "/health")</span>
      </div>
      <div class="config-item">
        <span class="config-name">timeout</span>
        <span class="config-desc">Request timeout duration</span>
      </div>
      <div class="config-item">
        <span class="config-name">interval</span>
        <span class="config-desc">Time between health checks</span>
      </div>
      <div class="config-item">
        <span class="config-name">unhealthy_threshold</span>
        <span class="config-desc">Failures before marking unhealthy</span>
      </div>
      <div class="config-item">
        <span class="config-name">healthy_threshold</span>
        <span class="config-desc">Successes before marking healthy</span>
      </div>
    </div>
  </section>

  <!-- Process Management -->
  <section class="section">
    <h2>Process Management</h2>
    <p>Control Ferron process lifecycle from your application:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
      </div>
      <pre><code>{{ codeExamples.processManagement }}</code></pre>
    </div>

    <div class="action-cards">
      <div class="action-card">
        <span class="action-icon">‚ñ∂Ô∏è</span>
        <span class="action-name">start()</span>
        <span class="action-desc">Start Ferron process</span>
      </div>
      <div class="action-card">
        <span class="action-icon">‚èπÔ∏è</span>
        <span class="action-name">stop()</span>
        <span class="action-desc">Stop Ferron gracefully</span>
      </div>
      <div class="action-card">
        <span class="action-icon">üîÑ</span>
        <span class="action-name">reload()</span>
        <span class="action-desc">Hot reload configuration</span>
      </div>
      <div class="action-card">
        <span class="action-icon">üîÅ</span>
        <span class="action-name">restart()</span>
        <span class="action-desc">Full process restart</span>
      </div>
    </div>
  </section>

  <!-- Security -->
  <section class="section">
    <h2>Security Headers</h2>
    <p>Add security headers to all proxied responses:</p>
    <div class="code-block">
      <div class="code-header">
        <span class="code-lang">rust</span>
      </div>
      <pre><code>{{ codeExamples.securityHeaders }}</code></pre>
    </div>
  </section>

  <!-- API Reference -->
  <section class="section api-section">
    <h2>API Reference</h2>
    @for (category of apiTypes; track category.category) {
      <div class="api-category">
        <h3>{{ category.category }}</h3>
        <div class="api-types">
          @for (type of category.types; track type.name) {
            <div class="api-type">
              <code>{{ type.name }}</code>
              <span>{{ type.description }}</span>
            </div>
          }
        </div>
      </div>
    }
  </section>

  <!-- Best Practices -->
  <section class="section">
    <h2>Best Practices</h2>
    <div class="best-practices">
      <div class="practice-card">
        <h4>1. Always Use Health Checks</h4>
        <p>Configure health checks on all load-balanced backends to ensure traffic only routes to healthy instances.</p>
      </div>
      <div class="practice-card">
        <h4>2. Implement Proper Health Endpoints</h4>
        <p>Your <code>/health</code> endpoint should check database, cache, and other critical dependencies.</p>
      </div>
      <div class="practice-card">
        <h4>3. Use Security Headers</h4>
        <p>Always configure X-Frame-Options, CSP, and other security headers to protect your application.</p>
      </div>
      <div class="practice-card">
        <h4>4. Rate Limit API Endpoints</h4>
        <p>Protect your APIs from abuse with per-location rate limiting.</p>
      </div>
      <div class="practice-card">
        <h4>5. Configure Backup Backends</h4>
        <p>Mark some backends as backups to handle traffic when primary backends are unavailable.</p>
      </div>
    </div>
  </section>

  <!-- Related Docs -->
  <section class="section related-section">
    <h2>Related Documentation</h2>
    <div class="related-grid">
      <a [routerLink]="['/docs', 'deployment']" class="related-card">
        <span class="related-icon">üöÄ</span>
        <h4>Deployment Guide</h4>
        <p>Deploy Armature with Ferron in production</p>
      </a>
      <a [routerLink]="['/docs', 'scaling']" class="related-card">
        <span class="related-icon">üìà</span>
        <h4>Scaling Guide</h4>
        <p>Scale your application horizontally</p>
      </a>
      <a [routerLink]="['/docs', 'security']" class="related-card">
        <span class="related-icon">üîí</span>
        <h4>Security Guide</h4>
        <p>Security best practices</p>
      </a>
    </div>
  </section>
</article>

